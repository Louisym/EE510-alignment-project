`torch_dtype` is deprecated! Use `dtype` instead!
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
================================================================================
COMPLETE MODEL EVALUATION
================================================================================

Loaded 10 test questions


================================================================================
1. EVALUATING BASE MODEL
================================================================================
Loading base model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.87s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.23s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.75s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.61s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.53s/it]
INFO:peft.tuners.tuners_utils:Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!

================================================================================
Evaluating Base Model
================================================================================

Question 1/10: 什么是条件概率？...
  Reward: 0.3050
  Generated (first 100 chars): 条件概率是概率论中的一种概率，即在事件A发生的条件下，事件B发生的概率。通常，我们表示为 \( P(B|A) \)， read as "the probability of B given A".

...

Question 2/10: 独立事件的乘法公式是什么？...
  Reward: 0.1700
  Generated (first 100 chars): 独立事件的乘法公式是：如果事件A和B是独立的，那么A和B同时发生的概率等于A发生的概率乘以B发生的概率。用数学公式表示为：P(A and B) = P(A) * P(B)。

例如，假设事件A是掷一个...

Question 3/10: 连续型随机变量的概率密度函数有什么性质？...
  Reward: 0.3050
  Generated (first 100 chars): 连续型随机变量的概率密度函数（Probability Density Function,PDF）必须满足以下性质：

1. 非负性：对于所有 \( x \)， \( f(x) \geq 0 \)。
2...

Question 4/10: 方差的计算公式是什么？...
  Reward: 0.3050
  Generated (first 100 chars): 方差是衡量数据点围绕平均值的分布的指标。方差的计算公式为：

\[
\sigma^2 = \frac{1}{N} \sum_{i=1}^N (x_i - \mu)^2
\]

其中 \(\sigma^...

Question 5/10: 中心极限定理的内容是什么？...
  Reward: 0.2192
  Generated (first 100 chars): 中心极限定理（Central Limit Theorem）是概率论中的一个 fundamental concept，它指出对于任何具有 finite variance 的 population，当样本...

Question 6/10: 什么是σ代数？...
  Reward: 0.4050
  Generated (first 100 chars): 在数学中，σ代数（或可测代数）是集合的集合，它包含空集，并且在 complement 和 countable union 的运算下封闭。σ代数是概率论和 measure theory 的 fundam...

Question 7/10: 布朗运动有什么特点？...
  Reward: 0.0800
  Generated (first 100 chars): 布朗运动是一种随机过程，具有以下特点：

1. 布朗运动在任何两个相等的时间间隔内移动的距离相同。

2. 布朗运动是连续的，意味着它在任何两个时间点之间都有定义。

3. 布朗运动是 Markov ...

Question 8/10: 马尔可夫性质是什么？...
  Reward: 0.3300
  Generated (first 100 chars): 马尔可夫性质是随机过程理论中的一个基本性质，它表示过程的未来 behavior depends only on its current state and not on its past states...

Question 9/10: 鞅的定义是什么？...
  Reward: 0.1700
  Generated (first 100 chars): 鞅是一个数学概念，表示一个数或函数在某一点的导数。导数是数学中一个重要的工具，用于描述函数的变化率和斜率。具体来说，函数 \( f(x) \) 在点 \( x = a \) 处的导数，记作 \( f'...

Question 10/10: 什么是大数定律？...
  Reward: 0.0200
  Generated (first 100 chars): 大数定律是概率论中的一个基本定律，它表明一个事件的频率在大量试验中接近于其概率。具体来说，大数定律表明，当试验次数{n}足够大时，观察到的事件频率{X/n}与事件的理论概率{p}之间的差值可以任意小。...


Base Model Average Reward: 0.2309


================================================================================
2. EVALUATING SFT (Random-init LoRA)
================================================================================
Loading SFT-Random from experiments/svd_lora/training_results/final_model_random...

================================================================================
Evaluating SFT Random-init
================================================================================

Question 1/10: 什么是条件概率？...
  Reward: 0.4450
  Generated (first 100 chars): 条件概率是事件A在事件B发生的条件下发生的概率。它由以下公式给出：
\[
P(A|B) = \frac{P(A \cap B)}{P(B)}
\]
其中 \( P(A \cap B) \) 是事件A和...

Question 2/10: 独立事件的乘法公式是什么？...
  Reward: 0.3700
  Generated (first 100 chars): 独立事件的乘法公式是：P(A and B) = P(A) * P(B).

This formula states that the probability of two independent ev...

Question 3/10: 连续型随机变量的概率密度函数有什么性质？...
  Reward: 0.3050
  Generated (first 100 chars): 连续型随机变量的概率密度函数（PDFs）有以下性质：

1. 非负性：对于所有 \( x \)，\( f(x) \geq 0 \)。
2. 归一性：函数在所有可能的 \( x \) 值上的积分等于 1...

Question 4/10: 方差的计算公式是什么？...
  Reward: 0.3050
  Generated (first 100 chars): 方差的计算公式是 $s^2 = \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2$，其中 $n$ 是数据点的数量，$x_i$ 是每个数据点，$\bar{x}$ ...

Question 5/10: 中心极限定理的内容是什么？...
  Reward: 0.1625
  Generated (first 100 chars): 中心极限定理 (Central Limit Theorem) 是概率论中的一个重要定理，它指出对于从具有有限方差的总体中抽取的任何样本，当样本量足够大时，样本均值的分布将接近正态分布， regardl...

Question 6/10: 什么是σ代数？...
  Reward: 0.2550
  Generated (first 100 chars): σ代数（sigma algebra）是数学中的一种集合运算，是满足以下条件的集合族：

1. 集合 itself is in the σ代数.
2. The complement of any set...

Question 7/10: 布朗运动有什么特点？...
  Reward: 0.1800
  Generated (first 100 chars): 布朗运动有以下特点：

1. 随机性：微粒的运动是随机的，无法预测。

2. 非确定性：微粒在给定的时间间隔内移动的距离是随机的，无法确定。

3. 均匀性：微粒在空间中的分布是均匀的。

4. 独立...

Question 8/10: 马尔可夫性质是什么？...
  Reward: 0.1700
  Generated (first 100 chars): 马尔可夫性质是马尔可夫链的无记忆性，即在给定当前状态的情况下， system的未来状态与它的过去状态无关。

马尔可夫性质可以数学地表示为：

\[ P(X_{n+1} = x_{n+1} \mid ...

Question 9/10: 鞅的定义是什么？...
  Reward: 0.1550
  Generated (first 100 chars): 一个函数 \( f(x) \) 在点 \( x = a \) 处是连续的，如果满足以下三个条件：
1. \( f(a) \) 在定义域内。
2. 极限 \( \lim_{x \to a} f(x) \...

Question 10/10: 什么是大数定律？...
  Reward: 0.1800
  Generated (first 100 chars): 大数定律是概率论中的一个基本定律，它描述了当试验次数足够大时，随机变量的平均值会以高概率收敛到其期望值。换句话说，大数定律表明，通过进行大量试验，我们可以用观察到的频率来近似概率。这个定律是概率论和统...


SFT Random-init Average Reward: 0.2528


================================================================================
3. EVALUATING SFT (SVD-init LoRA)
================================================================================
Loading SFT-SVD from experiments/svd_lora/training_results/final_model_svd...

================================================================================
Evaluating SFT SVD-init
================================================================================

Question 1/10: 什么是条件概率？...
  Reward: 0.4450
  Generated (first 100 chars): 条件概率是事件A在事件B发生的条件下发生的概率。它由以下公式给出：

\[ P(A|B) = \frac{P(A \cap B)}{P(B)} \]

其中 \( P(A \cap B) \) 是事件...

Question 2/10: 独立事件的乘法公式是什么？...
  Reward: 0.3500
  Generated (first 100 chars): 独立事件的乘法公式是：P(AB) = P(A)P(B)，其中P(A)和P(B)是两个独立事件A和B的概率。这个公式表示，两个独立事件同时发生的概率等于它们各自发生的概率的乘积。例如，如果事件A和B是独...

Question 3/10: 连续型随机变量的概率密度函数有什么性质？...
  Reward: 0.3800
INFO:peft.tuners.tuners_utils:Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  Generated (first 100 chars): 连续型随机变量的概率密度函数（PDF）具有以下性质：

1. 非负性：PDF对于所有可能的x值必须是非负的，即 f(x) ≥ 0 对于所有x。

2. 归一性：PDF在所有可能的x值上的积分必须等于1...

Question 4/10: 方差的计算公式是什么？...
  Reward: 0.3050
  Generated (first 100 chars): 方差是衡量数据点围绕平均值的分布的指标。方差的计算公式如下：

\[
\sigma^2 = \frac{1}{N} \sum_{i=1}^{N} (x_i - \mu)^2
\]

其中：
- \(\...

Question 5/10: 中心极限定理的内容是什么？...
  Reward: 0.2150
  Generated (first 100 chars): 中心极限定理（Central Limit Theorem）指出，如果样本量足够大，样本均值的分布将接近正态分布， regardless of the shape of the population d...

Question 6/10: 什么是σ代数？...
  Reward: 0.3300
  Generated (first 100 chars): σ代数（sigma-algebra）是数学中的一种集合运算，它满足以下三个条件：

1. ∅（空集）是σ代数的元素。
2. 如果A是σ代数的元素，那么A的补集A^c也是σ代数的元素。
3. 如果A_1...

Question 7/10: 布朗运动有什么特点？...
  Reward: 0.0800
  Generated (first 100 chars): 布朗运动有以下特点：

1. 随机性：布朗运动是随机的， directionless， 且在任何给定时间的运动方向是随机的。

2. 独立性：布朗运动在不同时间的运动是独立的，即一个时间的运动不会影响...

Question 8/10: 马尔可夫性质是什么？...
  Reward: 0.5200
  Generated (first 100 chars): 马尔可夫性质（Markov property）是马尔可夫链的基本性质，它表示在给定当前状态的情况下， system的未来状态与它的过去状态无关。用数学语言描述，对于马尔可夫链{Xn}，马尔可夫性质可以...

Question 9/10: 鞅的定义是什么？...
  Reward: 0.2550
  Generated (first 100 chars): 一个数列是收敛的，如果存在一个实数 L，对于任何正数 epsilon，存在一个正整数 N，使得对于所有 n > N，有 |a_n - L| < epsilon。

In other words, a ...

Question 10/10: 什么是大数定律？...
  Reward: 0.1400
  Generated (first 100 chars): 大数定律是概率论中的一个基本定律，它表明当样本量足够大时，样本均值将接近总体均值。这一定理在统计学和金融学中被广泛 used。

In probability theory, the Law of L...


SFT SVD-init Average Reward: 0.3020


================================================================================
4. EVALUATING GRPO
================================================================================
Loading GRPO from outputs/grpo/final_model...

================================================================================
Evaluating GRPO
================================================================================

Question 1/10: 什么是条件概率？...
  Reward: 0.4450
  Generated (first 100 chars): 条件概率是事件A在事件B发生的条件下发生的概率，记为P(A|B)。其公式为：

\[ P(A|B) = \frac{P(A \cap B)}{P(B)} \]

其中，\( P(A \cap B) \...

Question 2/10: 独立事件的乘法公式是什么？...
  Reward: 0.4600
  Generated (first 100 chars): 独立事件的乘法公式是：P(A and B) = P(A) * P(B).

 explanation: 当两个事件A和B是独立的，那么事件A和B同时发生的概率等于事件A发生的概率乘以事件B发生的概率。...

Question 3/10: 连续型随机变量的概率密度函数有什么性质？...
  Reward: 0.4400
  Generated (first 100 chars): 连续型随机变量的概率密度函数（PDF）满足以下性质：

1. 非负性：对于所有x，f(x) ≥ 0。
2.归一化：f(x)在x的整个范围内的积分等于1。即，\int_{-\infty}^{\infty...

Question 4/10: 方差的计算公式是什么？...
  Reward: 0.4050
  Generated (first 100 chars): 方差的计算公式是：$s^2 = \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2$，其中 $s^2$ 是方差，$n$ 是数据点的数量，$x_i$ 是每个数据点，...

Question 5/10: 中心极限定理的内容是什么？...
  Reward: 0.4050
  Generated (first 100 chars): 中心极限定理 (Central Limit Theorem) 是概率论中 important 的结果，它指出对于一个 large 的 independent and identically distr...

Question 6/10: 什么是σ代数？...
  Reward: 0.1550
  Generated (first 100 chars): 在概率论中，σ代数（也称为可测代数）是样本空间的子集的集合，它满足以下三个条件：

1. 样本空间本身是σ代数。
2. σ代数中的任何集合的补集也是σ代数。
3. σ代数中任意可数个集合的并集也是σ代...

Question 7/10: 布朗运动有什么特点？...
  Reward: 0.3300
  Generated (first 100 chars): 布朗运动的特点有：

1. 随机性：布朗运动是随机的，无法预测，具有随机性。

2. 均匀性：布朗运动在 space中是均匀分布的。

3. 连续性：布朗运动是连续的，没有 jumps。

4. 非独...

Question 8/10: 马尔可夫性质是什么？...
  Reward: 0.2150
  Generated (first 100 chars): The time complexity of the given function is O(n), where n is the value of the exponent. This is bec...

Question 9/10: 鞅的定义是什么？...
  Reward: 0.3700
  Generated (first 100 chars): �域（ field ） is a set of numbers that is closed under addition, subtraction, multiplication, and divi...

Question 10/10: 什么是大数定律？...
  Reward: 0.3650
  Generated (first 100 chars): 大数定律是概率论中一个 basic 的定律，它描述了当试验次数足够大时，随机事件的频率会收敛到其理论概率。大数定律是概率论的基础，它为概率论提供了一个 theoretical 的基础，使得我们可以用实...


GRPO Average Reward: 0.3590


================================================================================
SUMMARY OF ALL MODELS
================================================================================

Base Model          : 0.2309
SFT Random-init     : 0.2528
SFT SVD-init        : 0.3020
GRPO                : 0.3590

Improvements relative to Base Model     
------------------------------------------------------------
SFT Random-init     : +9.45%
SFT SVD-init        : +30.78%
GRPO                : +55.46%

✓ Detailed results saved to evaluation_results.json

================================================================================
EVALUATION COMPLETE
================================================================================
